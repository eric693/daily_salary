# 日薪員工管理系統

一個完整的日薪員工管理與薪資計算系統，支援即時同步資料到 Google 試算表。

## 📋 功能特色

### 員工設定頁面
- ✅ 完整的員工基本資料管理（ID、姓名、血型、聯絡資訊等）
- ✅ 薪資設定（日薪、加班時薪、伙食津貼）
- ✅ 加項津貼設定（開車津貼、職務津貼、租屋津貼、代付款）
- ✅ 減項扣款設定（勞保費、健保費、眷屬健保）
- ✅ 銀行資訊管理
- ✅ 備註功能

### 薪資計算頁面
- ✅ 自動計算日薪資
- ✅ 加班費計算
- ✅ 各項津貼與扣款處理
- ✅ 即時顯示計算結果
- ✅ 自動同步到 Google 試算表

## 🚀 部署步驟

### 步驟 1: 準備 Google 試算表

1. 前往 [Google 試算表](https://sheets.google.com/)
2. 建立一個新的試算表，命名為「日薪員工管理系統」
3. 複製試算表 URL 中的 ID
   ```
   URL 格式: https://docs.google.com/spreadsheets/d/【這裡是ID】/edit
   ```

### 步驟 2: 設定 Google Apps Script

1. 在試算表中，點選「擴充功能」→「Apps Script」
2. 刪除預設的程式碼
3. 複製 `Code.gs` 的內容並貼上
4. 修改第 9 行的 `SPREADSHEET_ID`：
   ```javascript
   const SPREADSHEET_ID = '貼上您的試算表ID';
   ```

### 步驟 3: 部署 Web App

1. 在 Apps Script 編輯器中，點選「部署」→「新增部署作業」
2. 選擇類型：「網頁應用程式」
3. 設定：
   - **說明**: 日薪員工管理系統 API
   - **執行身分**: 我
   - **具有存取權的使用者**: 任何人
4. 點選「部署」
5. 授權應用程式存取您的 Google 帳戶
6. **複製 Web 應用程式 URL**（很重要！）

### 步驟 4: 設定前端網頁

1. 開啟 `script.js` 檔案
2. 修改第 2 行，將 Web 應用程式 URL 貼上：
   ```javascript
   const SCRIPT_URL = '貼上您的Web應用程式URL';
   ```

### 步驟 5: 上傳到 GitHub

1. 建立新的 GitHub Repository
2. 上傳以下檔案：
   - `index.html`
   - `style.css`
   - `script.js`
   - `README.md`（本檔案）

3. 在 Repository 設定中啟用 GitHub Pages：
   - 前往 Settings → Pages
   - Source 選擇 `main` 分支
   - 點選 Save

4. 您的網站將會部署到：
   ```
   https://您的GitHub用戶名.github.io/Repository名稱/
   ```

## 📁 檔案說明

### index.html
主要的 HTML 檔案，包含：
- 員工設定表單
- 薪資計算表單
- 頁面切換功能

### style.css
樣式檔案，提供：
- 深色主題設計
- 響應式布局
- 美觀的表單樣式
- 動畫效果

### script.js
前端 JavaScript 檔案，負責：
- 表單資料收集
- 與 Google Apps Script 通訊
- 本地薪資計算
- 結果顯示
- 頁面切換邏輯

### Code.gs
Google Apps Script 後端程式，處理：
- 接收前端 POST 請求
- 儲存員工資料到試算表
- 計算並儲存薪資資料
- 資料驗證與錯誤處理

## 📊 試算表結構

系統會自動建立兩個工作表：

### 員工資料工作表
包含欄位：
- 時間戳記、員工ID、員工姓名、血型、手機
- 出生年月日、緊急聯絡人、緊急聯絡人電話、通訊地址
- 日薪、加班時薪、伙食津貼(天)
- 開車津貼、職務津貼、租屋津貼、代付款
- 勞保費、健保費、眷屬健保
- 銀行代碼、銀行帳號、備註

### 薪資計算工作表
包含欄位：
- 時間戳記、員工ID、計算年月、上班天數
- 加班時數、請假扣款、預支金額
- 代辦6小時扣款、其他代扣、罰單均分
- 基本日薪總額、加班費、津貼總額、扣款總額、實發薪資

## 💡 使用說明

### 新增員工

1. 開啟網頁系統
2. 填寫「日薪員工設定」表單
3. 必填欄位：員工ID、員工姓名、日薪、加班時薪
4. 點選「💾 儲存日薪員工資料」
5. 系統會自動儲存到 Google 試算表

### 計算薪資

1. 點選「下一步：計算日薪」或切換到計算頁面
2. 輸入員工ID和計算年月（必填）
3. 填寫上班天數、加班時數等資訊
4. 點選「🧮 開始計算日薪」
5. 系統會顯示計算結果並儲存到試算表

### 更新員工資料

- 使用相同的員工ID再次儲存，系統會自動更新資料

## 🔧 測試功能

在 Google Apps Script 中提供了測試函數：

```javascript
// 測試儲存員工資料
testSaveEmployee()

// 測試計算薪資
testCalculateSalary()
```

可以在 Apps Script 編輯器中執行這些函數來測試功能。

## ⚠️ 注意事項

1. **CORS 限制**: 由於瀏覽器的安全限制，前端使用 `no-cors` 模式，無法直接讀取後端回應
2. **權限設定**: 確保 Apps Script 部署時選擇「任何人」可存取
3. **資料驗證**: 系統會檢查必填欄位，請確保填寫完整
4. **網路連線**: 需要穩定的網路連線才能同步資料

## 🔒 安全性建議

1. 不要將 `SPREADSHEET_ID` 和 `SCRIPT_URL` 公開分享
2. 定期備份試算表資料
3. 限制試算表的編輯權限
4. 考慮為敏感資料加密

## 📞 疑難排解

### 問題：資料沒有儲存到試算表
- 檢查 `script.js` 中的 `SCRIPT_URL` 是否正確
- 確認 Apps Script 部署設定為「任何人」可存取
- 檢查瀏覽器 Console 是否有錯誤訊息

### 問題：計算結果不正確
- 確認員工資料已正確儲存
- 檢查輸入的數值是否正確
- 查看 Apps Script 的執行記錄

### 問題：GitHub Pages 無法顯示
- 確認 Repository 是公開的
- 檢查檔案名稱是否為 `index.html`
- 等待幾分鐘讓 GitHub Pages 完成部署

## 📝 授權

本專案採用 MIT 授權條款

## 🤝 貢獻

歡迎提出問題和改進建議！

---

**最後更新**: 2025年11月
**版本**: 1.0.0